<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="swaggeradder.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
    <title>Current Weather</title>
</head>

<body>
    <header id="pozadiVrchu">
        <div class="logo">
            <img src="WeatherWearLogo.png" height="80px">
        </div>
        <div class="poloha">
            <div id="lokace"></div>
        </div>
        <div class="pohlavi">
            <button class="Tlacitko" onclick="Tlacitko()" id="Tlacitko"><span id="textTlacitka">Žena</span></button>
        </div>
    </header>

    <div class="info">
        <div class="obloha">
            <div id="podnebi"></div>
        </div>
        <div class="teplota">
            <p id="aktualniTeplota"></p>
        </div>
        <div class="vitr">
            <p id="aktualniVitr"></p>
        </div>
    </div>

    <div class="kontroly">
        <p id="kontrolaPohlavi"></p>
        <!-- kontrola jestli se pohlaví zapisuje správně-->
        <p id="latlong"></p>
        <!-- kontrola jestli fungujou ty proměnné-->
    </div>

    <script>
        function pohlavi()
        {
            var pohlavi = "muz";
            kontrolaPohlavi.innerHTML = pohlavi;
        }

        function Tlacitko()
        {
            if (pohlavi == "zena")
            {
                document.getElementById("pozadiVrchu").style.backgroundColor = 'rgb(' + 52 + ',' + 152 + ',' + 219 + ')';
                document.getElementById("Tlacitko").style.backgroundColor = ' #FF69B4';
                pohlavi = "muz";
                kontrolaPohlavi.innerHTML = pohlavi;
                textTlacitka.innerHTML = "Žena";
            } 
            else
            {
                document.getElementById("pozadiVrchu").style.backgroundColor = 'rgb(' + 255 + ',' + 105 + ',' + 180 + ')';
                document.getElementById("Tlacitko").style.backgroundColor = '#3498DB';
                pohlavi = "zena"
                kontrolaPohlavi.innerHTML = pohlavi;
                textTlacitka.innerHTML = " Muž";
            }
        }
    </script>

    <script lang="text/javascript">
        function getLocation()
        {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition);
            } else {
                latlong.innerHTML = "Geolockace není podporována tímto prohlížečem.";
            }

        }
        console.log(lat);
        var lat = 10;
        var lon = 10;

        function showPosition(position)
        {
            lat = position.coords.latitude; //nastavuje ty tvoje const do API
            lon = position.coords.longitude;
            console.log(lat);
            latlong.innerHTML = lat + "<br>" + lon; // test jestli funguje to lat a long . a ano funguje
            onload = apiCall();
        }

        function apiCall() {
            var key = 'dd36dc5e73f05a1c2a28d85e662fb406';
            //fetch('https://api.openweathermap.org/data/2.5/weather?q=Kunda&lang=cz&units=metric&appid=' + key)
            fetch('https://api.openweathermap.org/data/2.5/weather?lat=' + lat + '&lon=' + lon + '&lang=cz&units=metric&appid=' + key)
                .then(function(resp) {
                    return resp.json()

                }) // Convert data to json
                .then(function(data) {
                    drawWeather(data);
                    console.log(data);
                })
                .catch(function() {
                    // catch any errors
                });
        }

        function drawWeather(d)
        {
            var teplota = Math.round(parseFloat(d.main.temp));
            var vitr = Math.round(parseFloat(d.wind.speed) * 3.6)

            document.getElementById('podnebi').innerHTML = d.weather[0].description;
            document.getElementById('aktualniTeplota').innerHTML = teplota + '&deg;C';
            document.getElementById('lokace').innerHTML = d.name;
            document.getElementById('aktualniVitr').innerHTML = vitr + 'km/h';
        }
        window.onload = function()
        {
            getLocation();
            pohlavi();
        }
    </script>
</body>

</html>